# MP1

Your code should compile to an executable named http_client with the following usage:

./http_client http://hostname[:port]/path/to/file

For example:
./http_client http://cs438.cs.illinois.edu/

./http_client http://localhost:5678/somedir/somefile.html

If :port is not specified, default to port 80 – the standard port for HTTP.

Your client should send an HTTP GET request based on the first argument it receives. Your client should then write
the message body of the received response to a file named output. Your client should also be able to handle redirects
as described in detail later.
You MUST use SO_REUSEADDR and SO_REUSEPORT when creating a socket. Failing to do so will lead to a penalty
(see Section 5 for the grade breakdown).

## Details on HTTP GET Request

Here's the very simple HTTP GET request generated by wget:

GET /test.txt HTTP/1.0

User-Agent: Wget/1.15 (linux-gnu)

Accept: */*

Host: localhost:3490

Connection: Keep-Alive

• GET /test.txt instructs the server to return the file called test.txt in the server's top-level web
directory.

• User-Agent identifies the type of client.

• Accept specifies what types of files are desired – the client could say “I only want audio”, or “I want text,
and I prefer html text”, etc. In this case it is saying “anything is fine”.

• Host is the URL that the client was originally told to get from – exactly what the user typed. This is useful
in case a single server has multiple domain names resolving to it (maybe www.cs.illinois.edu and
www.math.illinois.edu), and each domain name actually refers to different content. This could be a bare IP
address, if that's what the user had typed. The 3490 is the port – this server was listening on 3490, so I
called “wget localhost:3490/test.txt”.

• Connection: Keep-Alive refers to TCP connection reuse, which will be discussed in class.
Only the first line is essential for a server to know what file to give back, so your HTTP GETs can be just that first
line. HTTP specifies that the end of a request should be a marked by a blank line – so be sure to have two newlines
at the end. (This demarcation is necessary because TCP present you a stream of bytes, rather than packets.) Note that
the newlines are technically supposed to be CRLF - “\r\n”.
You may use either HTTP 1.0 or 1.1. However, notice that if you are using HTTP/1.0, the Host header is NOT
REQUIRED. If you are using HTTP/1.1, the Host header is REQUIRED. But be aware that the Host header may
still be necessary for some URLs even in HTTP/1.0.

## Handling Redirections

“The HTTP response status code 301 Moved Permanently is used for permanent URL redirection, meaning current
links or records using the URL that the response is received for should be updated. The new URL should be provided
in the Location field included with the response.” – Wikipedia page on HTTP 301
In some cases, the server may send back a status code 301, indicating that the content requested has been moved:
HTTP/1.1 301 Moved Permanently

Location: <new_url>

In such cases the client should attempt to retrieve the document in the <new_url> given in the Location field. Here
is an example from Wikipedia page:

Client request:
GET /index.php HTTP/1.1
Host: www.example.org 

Server response:
HTTP/1.1 301 Moved Permanently
Location:
http://www.example.org/index.asp

## The Assignment – HTTP Server

 ### The Basics
Your code should compile to an executable named http_server. It should take one command line argument (the port
number) and start listening on the port specified once started. Usage examples:

sudo ./http_server 80

./http_server 8888
(The sudo is there because using any port <1024 requires root access.)

You MUST use SO_REUSEADDR and SO_REUSEPORT when creating a socket. Failing to do so will lead to a penalty
(see Section 5 for the grade breakdown).
The server should handle HTTP GET requests by sending back HTTP responses, as described in detail below.
Your server program should treat all file paths it's asked for as being relative to its current working directory. (Meaning
just pass the client's request directly to fopen: if the client asks for somedir/somefile.txt, the correct argument to
fopen is “somedir/somefile.txt”).
Warning: running this http_server program essentially makes all files accessible by the http_server process
accessible by anyone who can send a request to the host. Discretion is advised (Only run it on a VM)!

## Details on HTTP response
Your server's headers can be much simpler (but still correct and complete): just the status line (the first line of the
header, contains the status code).
• When correctly returning the requested document, use “HTTP/1.0 200 OK”.

• When the client requests a non-existent file, use “HTTP/1.0 404 Not Found”. Note that you can still have
document text on a 404, allowing for nicely formatted/more informative message such as “whoops, file not
found!”

• For any other errors, use “HTTP/1.0 400 Bad Request”.

Per the HTTP standard, again an empty line (two CRLF, “\r\n\r\n”) marks the end of the header, and the start of
message body.
To summarize, your whole response should be: header + empty line + message body (the file requested if available)
Reading the Wikipedia page HTTP message body may be helpful

 ## Handling Concurrent Connections
 Your server must support concurrent connections: if one client is downloading a 10MB object, another client that
comes looking for a 10KB object shouldn't have to wait for the first to finish.
Hint: you can do so by handling each connection in a new thread.
